<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeedGo AI Messenger</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <!-- User Profile & Settings -->
            <div class="sidebar-header">
                <div class="user-profile">
                    <img src="https://ui-avatars.com/api/?name=User&background=22c55e&color=fff" alt="User" class="user-avatar">
                    <div class="user-info">
                        <h3>WeedGo AI</h3>
                        <span class="status-indicator online">Online</span>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn-icon" id="settings-btn" title="Settings">
                        <i class="fas fa-cog"></i>
                    </button>
                    <button class="btn-icon" id="new-chat-btn" title="New Chat">
                        <i class="fas fa-comment-medical"></i>
                    </button>
                </div>
            </div>

            <!-- System Config -->
            <div class="system-config">
                <div class="config-section">
                    <label for="agent-select">AI Agent</label>
                    <select id="agent-select" class="config-select">
                        <option value="dispensary">Dispensary Assistant</option>
                        <option value="medical">Medical Advisor</option>
                        <option value="cultivation">Cultivation Expert</option>
                        <option value="customer_service">Customer Service</option>
                    </select>
                </div>
                <div class="config-section">
                    <label for="model-select">Model</label>
                    <select id="model-select" class="config-select">
                        <option value="qwen_0.5b">Qwen 0.5B (Fast)</option>
                        <option value="gpt-3.5">GPT-3.5</option>
                        <option value="claude">Claude</option>
                    </select>
                </div>
                <div class="config-section">
                    <label>Voice Mode</label>
                    <div class="toggle-group">
                        <button class="toggle-btn active" data-mode="text">Text</button>
                        <button class="toggle-btn" data-mode="voice">Voice</button>
                        <button class="toggle-btn" data-mode="auto">Auto</button>
                    </div>
                </div>
            </div>

            <!-- Search -->
            <div class="search-container">
                <i class="fas fa-search"></i>
                <input type="text" id="search-input" placeholder="Search conversations...">
            </div>

            <!-- Personality/Contact List -->
            <div class="contacts-section">
                <div class="section-header">
                    <h4>AI Personalities</h4>
                </div>
                <div class="contacts-list" id="personalities-list">
                    <div class="contact-item active" data-personality="friendly">
                        <div class="contact-avatar">
                            <i class="fas fa-smile"></i>
                        </div>
                        <div class="contact-info">
                            <div class="contact-name">Friendly Budtender</div>
                            <div class="contact-status">Casual & helpful</div>
                        </div>
                        <div class="contact-meta">
                            <span class="badge">Active</span>
                        </div>
                    </div>
                    <div class="contact-item" data-personality="professional">
                        <div class="contact-avatar">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <div class="contact-info">
                            <div class="contact-name">Professional Consultant</div>
                            <div class="contact-status">Formal & detailed</div>
                        </div>
                    </div>
                    <div class="contact-item" data-personality="expert">
                        <div class="contact-avatar">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <div class="contact-info">
                            <div class="contact-name">Cannabis Expert</div>
                            <div class="contact-status">Technical & precise</div>
                        </div>
                    </div>
                    <div class="contact-item" data-personality="wellness">
                        <div class="contact-avatar">
                            <i class="fas fa-heart"></i>
                        </div>
                        <div class="contact-info">
                            <div class="contact-name">Wellness Guide</div>
                            <div class="contact-status">Health-focused</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Chats -->
            <div class="recent-chats">
                <div class="section-header">
                    <h4>Recent Conversations</h4>
                </div>
                <div class="chat-list" id="recent-chats-list">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>

        <!-- Main Chat Area -->
        <div class="main-chat">
            <!-- Chat Header -->
            <div class="chat-header">
                <div class="chat-info">
                    <div class="chat-avatar">
                        <i class="fas fa-smile"></i>
                    </div>
                    <div class="chat-details">
                        <h3 id="chat-title">Friendly Budtender</h3>
                        <span class="chat-status">
                            <span class="typing-indicator" style="display: none;">
                                <span></span><span></span><span></span> typing...
                            </span>
                            <span class="online-status">Active now</span>
                        </span>
                    </div>
                </div>
                <div class="chat-actions">
                    <button class="btn-icon" id="voice-call-btn" title="Voice Call">
                        <i class="fas fa-phone"></i>
                    </button>
                    <button class="btn-icon" id="video-call-btn" title="Video Call">
                        <i class="fas fa-video"></i>
                    </button>
                    <button class="btn-icon" id="chat-info-btn" title="Info">
                        <i class="fas fa-info-circle"></i>
                    </button>
                    <button class="btn-icon" id="more-options-btn" title="More">
                        <i class="fas fa-ellipsis-v"></i>
                    </button>
                </div>
            </div>

            <!-- Messages Container -->
            <div class="messages-container" id="messages-container">
                <div class="date-divider">
                    <span>Today</span>
                </div>
                
                <!-- Welcome Message -->
                <div class="message received">
                    <div class="message-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <div class="message-bubble">
                            <p>Hey there! ðŸ‘‹ I'm your friendly AI budtender. How can I help you today?</p>
                            <p>I can assist with:</p>
                            <ul>
                                <li>Product recommendations</li>
                                <li>Strain information</li>
                                <li>Dosage guidance</li>
                                <li>Order assistance</li>
                            </ul>
                        </div>
                        <div class="message-time">Just now</div>
                    </div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="input-area">
                <!-- Voice Recording Overlay -->
                <div class="voice-overlay" id="voice-overlay" style="display: none;">
                    <div class="voice-animation">
                        <div class="wave"></div>
                        <div class="wave"></div>
                        <div class="wave"></div>
                    </div>
                    <div class="voice-timer" id="voice-timer">00:00</div>
                    <div class="voice-status">Hold to record, release to send</div>
                    <button class="voice-cancel" id="voice-cancel">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>

                <!-- Input Controls -->
                <div class="input-controls">
                    <button class="btn-icon" id="attach-btn" title="Attach">
                        <i class="fas fa-paperclip"></i>
                    </button>
                    <div class="input-wrapper">
                        <textarea 
                            id="message-input" 
                            placeholder="Type a message..." 
                            rows="1"
                            maxlength="1000"
                        ></textarea>
                        <button class="emoji-btn" id="emoji-btn" title="Emoji">
                            <i class="far fa-smile"></i>
                        </button>
                    </div>
                    <button class="btn-icon btn-voice" id="voice-btn" title="Push to Talk">
                        <i class="fas fa-microphone"></i>
                    </button>
                    <button class="btn-icon btn-send" id="send-btn" title="Send" style="display: none;">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Right Panel (Info/Settings) -->
        <div class="right-panel" id="right-panel" style="display: none;">
            <div class="panel-header">
                <h3>Chat Information</h3>
                <button class="btn-icon" id="close-panel">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="panel-content">
                <div class="info-section">
                    <h4>Current Settings</h4>
                    <div class="info-item">
                        <span class="label">Agent:</span>
                        <span class="value" id="info-agent">Dispensary Assistant</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Personality:</span>
                        <span class="value" id="info-personality">Friendly</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Model:</span>
                        <span class="value" id="info-model">Qwen 0.5B</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Session ID:</span>
                        <span class="value mono" id="info-session">-</span>
                    </div>
                </div>

                <div class="info-section">
                    <h4>Statistics</h4>
                    <div class="info-item">
                        <span class="label">Messages:</span>
                        <span class="value" id="stat-messages">0</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Tokens Used:</span>
                        <span class="value" id="stat-tokens">0</span>
                    </div>
                    <div class="info-item">
                        <span class="label">Response Time:</span>
                        <span class="value" id="stat-response">-</span>
                    </div>
                </div>

                <div class="panel-actions">
                    <button class="btn btn-secondary" id="clear-chat">
                        <i class="fas fa-broom"></i> Clear Chat
                    </button>
                    <button class="btn btn-secondary" id="export-chat">
                        <i class="fas fa-download"></i> Export Chat
                    </button>
                    <button class="btn btn-danger" id="end-session">
                        <i class="fas fa-stop"></i> End Session
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settings-modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="btn-icon" id="close-settings">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>API Configuration</h3>
                    <div class="form-group">
                        <label for="api-url">API URL</label>
                        <input type="text" id="api-url" value="http://localhost:5024" />
                    </div>
                    <div class="form-group">
                        <label for="api-key">API Key (Optional)</label>
                        <input type="password" id="api-key" placeholder="Enter API key if required" />
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Voice Settings</h3>
                    <div class="form-group">
                        <label for="voice-lang">Language</label>
                        <select id="voice-lang">
                            <option value="en-US">English (US)</option>
                            <option value="es-ES">Spanish</option>
                            <option value="fr-FR">French</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="voice-auto-send" checked />
                            Auto-send after recording
                        </label>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Appearance</h3>
                    <div class="form-group">
                        <label>Theme</label>
                        <div class="toggle-group">
                            <button class="toggle-btn active" data-theme="light">Light</button>
                            <button class="toggle-btn" data-theme="dark">Dark</button>
                            <button class="toggle-btn" data-theme="auto">Auto</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-settings">Cancel</button>
                <button class="btn btn-primary" id="save-settings">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Scripts -->
    <script src="app.js"></script>
</body>
</html>